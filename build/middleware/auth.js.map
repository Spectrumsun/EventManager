{"version":3,"sources":["../../server/middleware/auth.js"],"names":["Auth","req","res","next","token","body","query","headers","secret","process","env","SECRET","verify","err","data","status","json","message","user"],"mappings":";;;;;;;;AAAA;;;;;;;;IAGMA,I;;;;;;;gCACeC,G,EAAKC,G,EAAKC,I,EAAM;AACjC,UAAMC,QAAQH,IAAII,IAAJ,CAASD,KAAT,IAAkBH,IAAIK,KAAJ,CAAUF,KAA5B,IAAqCH,IAAIM,OAAJ,CAAY,gBAAZ,CAAnD;AACA,UAAIH,KAAJ,EAAW;AACT,YAAMI,SAASC,QAAQC,GAAR,CAAYC,MAA3B;AACA,+BAAIC,MAAJ,CAAWR,KAAX,EAAkBI,MAAlB,EAA0B,UAACK,GAAD,EAAMC,IAAN,EAAe;AACvC,cAAID,GAAJ,EAAS;AACP,mBAAOX,IAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,uBAAS;AADiB,aAArB,CAAP;AAGD;AACDhB,cAAIiB,IAAJ,GAAWJ,IAAX;;AAEAX;AACD,SATD;AAUD,OAZD,MAYO;AACL,eAAOD,IAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,mBAAS;AADiB,SAArB,CAAP;AAGD;AACF;;;;;;kBAIYjB,I","file":"auth.js","sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\n\r\nclass Auth {\r\n  static verifyToken(req, res, next) {\r\n    const token = req.body.token || req.query.token || req.headers['x-access-token'];\r\n    if (token) {\r\n      const secret = process.env.SECRET;\r\n      jwt.verify(token, secret, (err, data) => {\r\n        if (err) {\r\n          return res.status(401).json({\r\n            message: 'Authentication failed',\r\n          });\r\n        }\r\n        req.user = data;\r\n        \r\n        next();\r\n      });\r\n    } else {\r\n      return res.status(403).json({\r\n        message: 'You need to sign up or login',\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\n\r\nexport default Auth;\r\n"]}